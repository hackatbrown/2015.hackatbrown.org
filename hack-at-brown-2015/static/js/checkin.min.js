function onMessage(e){angular.element($("#scope")).scope().updateTotal(e.data)}var checkinApp=angular.module("checkinApp",["ngAnimate"]).config(function(e){e.startSymbol("%%").endSymbol("%%")});checkinApp.directive("shortcut",function(){return{restrict:"E",replace:!0,scope:!0,link:function(e){$(document).on("keyup",function(n){e.$apply(e.keyPressed(n))})}}}),checkinApp.animation(".slide-animation",function(){return{addClass:function(e,n,o){"ng-hide"==n&&$(e).stop().show().slideToggle(200,"swing",o)},removeClass:function(e,n,o){"ng-hide"==n&&$(e).stop().hide().slideToggle(200,"swing",o)},leave:function(){console.log("left")},enter:function(){console.log("enered")}}}),checkinApp.controller("Controller",["$scope","$http",function(e,n){e.missingOptionalInfo=null,e.requiredInfo=null,e.reminders=null,e.showStatus=null,e.hacker={},e.notification,e.session_checked_in=0,e.total_checked_in=initial_total_checked_in,e.keyPressed=function(n){if(n.ctrlKey)switch(n.which){case 13:e.checkinHacker();break;case 72:e.createPerson("Hacker");break;case 86:e.createPerson("Volunteer");break;case 82:e.createPerson("Rep");break;case 73:e.createPerson("Visitor");break;case 83:searchBar.focus()}},e.requestMoreInfo=function(){return e.clearNotifications(),e.newPerson=!1,""===e.hackerID?(e.hacker={},e.missingOptionalInfo=null,e.requiredInfo=null,e.reminders=null,void(e.showStatus=null)):(e.collectedInfo={},void n.get("/checkin/info/"+e.hackerID).success(function(n){e.hacker=n.hacker,e.showStatus=!0,e.hacker.checked_in||(e.missingOptionalInfo=n.missingOptionalInfo.length>0?n.missingOptionalInfo:null,e.requiredInfo=Object.keys(n.requiredInfo).length>0?n.requiredInfo:null,e.reminders=n.reminders,e.showCheckin=!e.requiredInfo,e.requiredInfo&&setTimeout(function(){$("input[type=tel]").mask("(999) 999-9999"),$("#required-info input")[0].focus()},100))}).error(function(n){console.log(n),e.notify("Error!")}))},e.clearNotifications=function(){e.notify("")},e.notify=function(n){e.notification=n},e.checkinHacker=function(){if(""===e.hackerID)return void console.log("id is null");if(!e.showCheckin)return void e.notify("You must obtain the required info before you can check in.");if(e.hacker.id===$("#search").val())return e.hacker.checked_in?void e.notify("Already Checked In"):"confirmed"!=e.hacker.status&&"waitlisted"!=e.hacker.status?void e.notify("Status Not Confirmed"):void n.post("/checkin",{id:e.hackerID}).success(function(n){n.success&&(e.hacker.checked_in=!0,e.reminders=!1,e.missingOptionalInfo=!1,e.requiredInfo=!1,e.showCheckin=!1,e.hacker.status="checked in",e.total_checked_in=n.total_checked_in,e.session_checked_in++,searchBar.focus())}).error(function(e){console.log(e)})},e.updateTotal=function(n){e.$apply(function(){e.total_checked_in=n})},e.createPerson=function(n){e.missingOptionalInfo=null,e.requiredInfo=null,e.reminders=null,e.showStatus=null,e.showCheckin=null,e.hacker={},$search[0].selectize.clear();var o=["email","name"];switch(n){case"Hacker":o=o.concat(["phone_number"]);break;case"Visitor":o=o.concat(["org"]);break;case"Volunteer":o=o.concat(["role","phone_number","shirt_gen","shirt_size"]);break;case"Rep":o=o.concat(["company","phone_number","shirt_gen","shirt_size"]);break;default:return void console.log("not a thing")}e.newPerson={kind:n,fields:o},setTimeout(function(){$("#newPerson-email").focus()},100)},e.cancelPerson=function(){e.$apply(function(){e.newPerson=null})},e.submitNewPerson=function(){function o(n){e.notify("Could not create person: "+n)}n.post("/checkin/new",e.newPerson).success(function(n){n.success?e.notify("Created and checked in!"):o(n.msg),e.newPerson=null}).error(function(e){console.log("error"),o(e)})},e.requiredHandled=function(){e.collectedInfo.id=e.hackerID,n.post("/checkin/requiredInfo",e.collectedInfo).success(function(n){n.success?(e.requiredInfo=null,e.showStatus=!0,e.showCheckin=!0,e.notify("Saved!")):e.notify("Invalid Number")}).error(function(){e.collectedInfo={}})}}]);